{% extends "adminpanel/base.html" %}
{% block title %}Edit Task{% endblock %}
{% block content %}
{% if messages %}{% for msg in messages %}<div class="alert alert-{{ msg.tags }}">{{ msg }}</div>{% endfor %}{% endif %}

<h2 class="mb-3">Edit Task #{{ task.id }}</h2>

<form method="post" class="card p-3 shadow">
  {% csrf_token %}
  <div class="mb-2">
    <label class="form-label">Title</label>
    <input class="form-control" name="title" value="{{ task.title }}" required>
  </div>
  <div class="mb-2">
    <label class="form-label">Description</label>
    <input class="form-control" name="description" value="{{ task.description }}">
  </div>
  <div class="row g-2">
    <div class="col-md-4">
      <label class="form-label">Due Date</label>
      <input type="date" name="due_date" class="form-control" value="{{ task.due_date|date:'Y-m-d' }}">
    </div>
    <div class="col-md-4">
      <label class="form-label">Assign To</label>
      <select name="assigned_to" class="form-select">
        {% for u in users %}
        <option value="{{ u.id }}" {% if task.assigned_to.id == u.id %}selected{% endif %}>{{ u.username }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label">Status</label>
      <select name="status" class="form-select">
        <option value="Pending" {% if task.status == "Pending" %}selected{% endif %}>Pending</option>
        <option value="In Progress" {% if task.status == "In Progress" %}selected{% endif %}>In Progress</option>
        <!-- Admin should not set Completed; users submit completion with report -->
      </select>
    </div>
  </div>

  <div class="mt-3">
    <button class="btn btn-primary">Update Task</button>
    <a href="{% url 'task_list' %}" class="btn btn-secondary">Cancel</a>
  </div>
</form>
{% endblock %}
